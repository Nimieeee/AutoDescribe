(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[811],{5158:function(e,t,r){Promise.resolve().then(r.bind(r,7771))},7771:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return GeneratePage}});var s=r(7437),n=r(2265),a=r(7823);let CSVRAGService=class CSVRAGService{async generateContentWithRAG(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"description",r=arguments.length>2?arguments[2]:void 0;try{let s=await fetch("".concat(this.apiUrl,"/api/generate-with-rag"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sku:e,content_type:t,custom_prompt:r})}),n=await s.json();if(!s.ok)return{success:!1,error:n.error||"Failed to generate content"};return{success:!0,content:n.generated_text,ragContext:n.rag_context}}catch(e){return console.error("RAG generation error:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async searchProducts(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;try{let r=await fetch("".concat(this.apiUrl,"/api/search-products?q=").concat(encodeURIComponent(e),"&limit=").concat(t));if(!r.ok)throw Error("Failed to search products");let s=await r.json();return s.products||[]}catch(e){return console.error("Product search error:",e),[]}}async getProductBySku(e){try{let t=await fetch("".concat(this.apiUrl,"/api/product/").concat(e));if(!t.ok)return null;let r=await t.json();return r.product||null}catch(e){return console.error("Get product error:",e),null}}constructor(){this.apiUrl="http://localhost:3000"}};let i=new CSVRAGService;var o=r(8098);function GeneratePage(){var e,t;let[r,c]=(0,n.useState)(""),[l,d]=(0,n.useState)("description"),[u,h]=(0,n.useState)(""),[m,g]=(0,n.useState)(!1),[x,p]=(0,n.useState)(null),[v,b]=(0,n.useState)(null),[f,y]=(0,n.useState)(""),[w,k]=(0,n.useState)([]),[j,N]=(0,n.useState)(!1),{trackPageView:_,trackSearch:I,trackGenerationRequest:C,trackUserInteraction:S}=(0,o._)();(0,n.useEffect)(()=>{_()},[]);let handleSearch=async e=>{if(!e.trim()){k([]);return}N(!0);let t=Date.now();try{let r=await i.searchProducts(e,10);k(r);let s=Date.now()-t;I(e,r.length,s)}catch(e){console.error("Search error:",e)}finally{N(!1)}},selectProduct=e=>{c(e.sku),k([]),y(""),S("select","product_search_result",{sku:e.sku,product_name:e.name})},handleGenerate=async()=>{if(!r.trim()){b("Please enter a product SKU");return}g(!0),b(null),p(null),C(r,l);try{let e=await i.generateContentWithRAG(r,l,u);if(!e.success)throw Error(e.error||"Failed to generate content");let{data:t}=await a.O.from("generated_content").select("\n          *,\n          products (sku, name, brand)\n        ").eq("generated_text",e.content).order("created_at",{ascending:!1}).limit(1).single();p({...t,rag_context:e.ragContext})}catch(e){b(e.message)}finally{g(!1)}};return(0,s.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Generate Descriptions"}),(0,s.jsx)("p",{className:"text-gray-600 mt-2",children:"Create AI-powered product descriptions with AutoDescribe"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Content Generation"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Products (CSV Data)"}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("input",{type:"text",value:f,onChange:e=>y(e.target.value),placeholder:"Search by name, brand, or category...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyPress:e=>"Enter"===e.key&&handleSearch(f)}),(0,s.jsx)("button",{onClick:()=>handleSearch(f),disabled:j,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 disabled:bg-gray-400",children:j?"...":"Search"})]}),w.length>0&&(0,s.jsx)("div",{className:"mt-2 max-h-40 overflow-y-auto border border-gray-200 rounded-md",children:w.map((e,t)=>(0,s.jsxs)("div",{onClick:()=>selectProduct(e),className:"p-2 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0",children:[(0,s.jsx)("div",{className:"font-medium text-sm",children:e.name}),(0,s.jsxs)("div",{className:"text-xs text-gray-500",children:["SKU: ",e.sku," | Brand: ",e.brandName," | Category: ",e.primary_category]})]},t))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product SKU"}),(0,s.jsx)("input",{type:"text",value:r,onChange:e=>c(e.target.value),placeholder:"Enter SKU or search above (e.g., B00GS8W3T4)",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Content Type"}),(0,s.jsxs)("select",{value:l,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,s.jsx)("option",{value:"description",children:"Product Description"}),(0,s.jsx)("option",{value:"features",children:"Feature List"}),(0,s.jsx)("option",{value:"benefits",children:"Benefits Summary"}),(0,s.jsx)("option",{value:"seo",children:"SEO Content"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Custom Instructions (Optional)"}),(0,s.jsx)("textarea",{value:u,onChange:e=>h(e.target.value),placeholder:"Add specific requirements or focus areas...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsx)("button",{onClick:handleGenerate,disabled:m,className:"w-full bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-not-allowed",children:m?"Generating with CSV Context...":"Generate Content with RAG"}),v&&(0,s.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:(0,s.jsx)("p",{className:"text-red-600 text-sm",children:v})})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Generated Content"}),x?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-md",children:(0,s.jsx)("p",{className:"text-green-800 text-sm font-medium",children:"✅ Content generated successfully and saved to review queue!"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Product"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[null===(e=x.products)||void 0===e?void 0:e.name," (SKU: ",null===(t=x.products)||void 0===t?void 0:t.sku,")"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Generated Text"}),(0,s.jsx)("div",{className:"p-4 bg-gray-50 rounded-md border",children:(0,s.jsx)("div",{className:"text-gray-900 whitespace-pre-wrap text-sm leading-relaxed",children:x.generated_text})})]}),x.seo_keywords&&x.seo_keywords.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"SEO Keywords"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:x.seo_keywords.map((e,t)=>(0,s.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:e},t))})]}),x.rag_context&&(0,s.jsxs)("div",{className:"p-3 bg-green-50 border border-green-200 rounded-md",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-green-800 mb-2",children:"\uD83E\uDDE0 CSV RAG Context Used"}),(0,s.jsxs)("div",{className:"text-xs text-green-700 space-y-1",children:[(0,s.jsxs)("p",{children:["✅ Target Product: ",x.rag_context.targetProduct.name]}),(0,s.jsxs)("p",{children:["\uD83D\uDCCA Similar Products: ",x.rag_context.similarProducts.length," found"]}),(0,s.jsxs)("p",{children:["\uD83C\uDFF7️ Category Products: ",x.rag_context.categoryProducts.length," found"]}),(0,s.jsxs)("p",{children:["\uD83D\uDD0D Brand Products: ",x.rag_context.brandProducts.length," found"]}),(0,s.jsx)("p",{children:"\uD83D\uDCDD Context generated from your CSV product database"})]})]}),(0,s.jsx)("div",{className:"pt-4 border-t",children:(0,s.jsx)("a",{href:"/review",className:"inline-flex items-center px-4 py-2 bg-green-600 text-white text-sm rounded-md hover:bg-green-700",children:"\uD83D\uDCCB Go to Review Queue"})})]}):(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"text-gray-400 text-6xl mb-4",children:"✨"}),(0,s.jsx)("p",{className:"text-gray-500",children:"Generated content will appear here"})]})]})]})]})}},8098:function(e,t,r){"use strict";r.d(t,{_:function(){return useKPITracking}});let ClientKPITracker=class ClientKPITracker{getOrCreateSessionId(){let e=localStorage.getItem("kpi-session-id");return e||(e="client_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),localStorage.setItem("kpi-session-id",e)),e}setupEventListeners(){this.trackPageView(),document.addEventListener("click",e=>{var t,r;let s=e.target;if("BUTTON"===s.tagName||s.closest("button")){let e="BUTTON"===s.tagName?s:s.closest("button");this.trackUserInteraction("click","button",{button_text:null==e?void 0:null===(t=e.textContent)||void 0===t?void 0:t.trim(),button_id:null==e?void 0:e.id,button_class:null==e?void 0:e.className})}if("A"===s.tagName||s.closest("a")){let e="A"===s.tagName?s:s.closest("a");this.trackUserInteraction("click","link",{link_text:null==e?void 0:null===(r=e.textContent)||void 0===r?void 0:r.trim(),link_href:null==e?void 0:e.href,link_id:null==e?void 0:e.id})}if("submit"===s.type){let e=s.closest("form");this.trackUserInteraction("submit","form",{form_id:null==e?void 0:e.id,form_class:null==e?void 0:e.className})}}),document.addEventListener("input",e=>{var t;let r=e.target;("search"===r.type||(null===(t=r.placeholder)||void 0===t?void 0:t.toLowerCase().includes("search")))&&(clearTimeout(r.searchTimeout),r.searchTimeout=setTimeout(()=>{this.trackUserInteraction("search_input","search_field",{query_length:r.value.length,has_query:r.value.length>0})},500))}),window.addEventListener("beforeunload",()=>{let e=Date.now()-this.startTime;this.trackUserInteraction("page_exit","page",{time_on_page_ms:e,page_url:window.location.pathname}),this.flushEvents()});let e=0;window.addEventListener("scroll",()=>{let t=Math.round(window.scrollY/(document.body.scrollHeight-window.innerHeight)*100);t>e&&(e=t,t%25==0&&this.trackUserInteraction("scroll","page",{scroll_depth:t,page_url:window.location.pathname}))})}trackPageView(){this.trackEvent({type:"page_view",timestamp:new Date,sessionId:this.sessionId,metadata:{page_url:window.location.pathname,page_title:document.title,referrer:document.referrer,user_agent:navigator.userAgent,viewport_width:window.innerWidth,viewport_height:window.innerHeight}})}trackUserInteraction(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.trackEvent({type:"user_interaction",timestamp:new Date,sessionId:this.sessionId,metadata:{action:e,element:t,page:window.location.pathname,timestamp:Date.now(),...r}})}trackSearch(e,t,r){this.trackEvent({type:"search",timestamp:new Date,sessionId:this.sessionId,metadata:{query:e.length>50?"".concat(e.substring(0,50),"..."):e,query_length:e.length,results_count:t,response_time_ms:r,has_results:t>0}})}trackGenerationRequest(e,t){this.trackEvent({type:"generation_request",timestamp:new Date,sessionId:this.sessionId,metadata:{sku:e,content_type:t,page:window.location.pathname}})}trackEvent(e){this.isTracking&&(this.eventQueue.push(e),this.eventQueue.length>=10&&this.flushEvents())}async flushEvents(){if(0===this.eventQueue.length)return;let e=[...this.eventQueue];this.eventQueue=[];try{await fetch("/api/kpi/client-events",{method:"POST",headers:{"Content-Type":"application/json","X-Session-ID":this.sessionId},body:JSON.stringify({events:e})}),console.log("\uD83D\uDCCA Sent ".concat(e.length," client KPI events"))}catch(t){console.error("Error sending KPI events:",t),this.eventQueue.unshift(...e)}}setTracking(e){this.isTracking=e,e?console.log("\uD83D\uDCCA KPI tracking enabled"):console.log("\uD83D\uDCCA KPI tracking disabled")}getSessionInfo(){return{sessionId:this.sessionId,startTime:this.startTime,queueLength:this.eventQueue.length,isTracking:this.isTracking}}constructor(){this.eventQueue=[],this.isTracking=!0,this.sessionId=this.getOrCreateSessionId(),this.startTime=Date.now(),this.setupEventListeners()}};let s=null;function getKPITracker(){return s||(s=new ClientKPITracker),s}function useKPITracking(){let e=getKPITracker();return{trackPageView:()=>e.trackPageView(),trackUserInteraction:(t,r,s)=>e.trackUserInteraction(t,r,s),trackSearch:(t,r,s)=>e.trackSearch(t,r,s),trackGenerationRequest:(t,r)=>e.trackGenerationRequest(t,r),flushEvents:()=>e.flushEvents(),setTracking:t=>e.setTracking(t),getSessionInfo:()=>e.getSessionInfo()}}getKPITracker()},7823:function(e,t,r){"use strict";r.d(t,{O:function(){return n}});var s=r(5257);let n=(0,s.eI)("https://aulrmuonepdwxklhcaez.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF1bHJtdW9uZXBkd3hrbGhjYWV6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYxMDUxOTIsImV4cCI6MjA3MTY4MTE5Mn0.oiaXgNNXx5U6rcZmxqT1gOTQqtVIUCSjMRr7AUTQM8Q")}},function(e){e.O(0,[849,971,472,744],function(){return e(e.s=5158)}),_N_E=e.O()}]);